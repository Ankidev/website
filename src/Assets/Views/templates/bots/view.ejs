<%- include("../../partials/header.ejs") %>
<script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {
                "@type": "ListItem",
                "position": 1,
                "name": "Home",
                "item": "https://discordextremelist.xyz/"
            },
            {
                "@type": "ListItem",
                "position": 2,
                "name": "Bots",
                "item": "https://discordextremelist.xyz/bots"
            },
            {
                "@type": "ListItem",
                "position": 2,
                "name": "<%= bot.name %>",
                "item": "https://discordextremelist.xyz/bots/<%= bot._id %>"
            }
        ]
    }
</script>
<%- include("../../partials/nav.ejs") %>
<style type="text/css">h1{font-size:48px}h2{font-size:40px}h3{font-size:32px}h4{font-size:24px}h5{font-size:20px}h6{font-size:16px}strong{color:#fff}code{background-color:#1f1f1f}pre{color:#ff3860;background-color:#1f1f1f}table th{color:#d2d2d2}a:hover{color:#1c5abd}.content h1,.content h2,.content h3,.content h4,.content h5,.content h6{color:#fff;font-weight:inherit}table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all;-webkit-overflow-scrolling:touch}blockquote{background-color:transparent!important;}</style>
<section class="hero is-primary">
    <div class="hero-body">
        <div class="container">
            <br />
            <div class="columns">
                <div class="column is-2">
                    <% 
                        let statusInfo;
                        if (botStatus === "online") statusInfo = __("The bot's status is currently Online.")
                        if (botStatus === "idle") statusInfo = __("The bot's status is currently Idle.")
                        if (botStatus === "dnd") statusInfo = __("The bot's status is currently Do not Disturb.")
                        if (botStatus === "offline") statusInfo = __("The bot's status is currently Offline.")
                    %> 
                    <img class="image" title="<%= statusInfo %>" style="<% if (mobile) { %>display: block; margin-left: auto; margin-right: auto;<% } %> border-radius: 50%; animation: <%= botStatus %> 2s infinite !important;" src="<%= bot.avatar.url %>.<%= imageFormat %>?size=128" alt="<%= bot.name %>'s Avatar" onerror="this.onerror = null;this.src = '/img/defaultavatar.<%= imageFormat %>';console.log('Failed to load item\'s avatar/icon, using default instead.');" draggable="false">
                </div>
            <div class="column is-10 <% if (mobile) { %>has-text-centered<% } %>">
                    <h1 class="is-size-1">
                        <span id="botName"><%= bot.name %></span>
                        <% if (bot.status.verified === true) { %>
                            <span style="vertical-align: middle;" title="<%= __("Verified Bot") %>" class="icon is-medium is-size-3 iconalign">
                                <i aria-hidden="true" class="fad fa-badge-check has-text-magenta fa-1x"></i>
                            </span>
                        <% } %>

                        <% if (bot.status.siteBot === true) { %>
                            <span style="vertical-align: middle;" title="<%= __("Site Bot - This bot is one of our official site bots and has been added for internal reasons.. It will not show up in search results, the homepage or the bot list page.") %>" class="icon is-size-3 is-medium iconalign">
                                <i aria-hidden="true" class="fad fa-cogs has-text-grey-lighter fa-1x"></i>
                            </span>
                        <% } %>

                        <% if (bot.status.approved === false) { %>
                            <span style="vertical-align: middle;" title="<%= __("Unapproved Bot") %>" class="icon is-medium is-size-3 iconalign">
                                <i aria-hidden="true" class="fad fa-exclamation-triangle has-text-danger fa-1x"></i>
                            </span>
                        <% } %>
                    </h1>
                    <h2 class="subtitle"><%= bot.shortDesc %></h2>
                    <div class="buttons <% if (mobile) { %>is-centered<% } %>">
                        <a href="/bots/<%= bot._id %>/upvote" class="button <% if (req.user && bot.votes.positive.includes(req.user._id)) { %>is-success<% } else { %>is-dark<% } %>">
                            <span class="icon">
                                <i aria-hidden="true" class="fas fa-arrow-alt-up"></i>
                            </span>
                        </a>
                        <% if (votes > 0) { %>
                            <span class="button is-black is-hovered has-text-success" title="<%= __("Votes") %></span>"><%= votes %></span>
                        <% } else if (votes === 0) { %>
                            <span class="button is-black is-hovered has-text-grey-light" title="<%= __("Votes") %>"><%= votes %></span>
                        <% } else if (votes < 0) { %>
                            <span class="button is-black is-hovered has-text-danger" title="<%= __("Votes") %>"><%= votes %></span>
                        <% } %>
                        <a href="/bots/<%= bot._id %>/downvote" class="button <% if (req.user && bot.votes.negative.includes(req.user._id)) { %>is-danger<% } else { %>is-dark<% } %>">
                            <span class="icon">
                                <i aria-hidden="true" class="fas fa-arrow-alt-down"></i>
                            </span>
                        </a>
                    </div>
                    <% if (req.user) { %>
                        <div class="buttons <% if (mobile) { %>is-centered<% } %>">
                        <% if (bot.owner._id === req.user._id) { %>
                            <button class="button is-dark" onclick="copyToClipboard('<%= bot.token %>');">
                                <span class="icon">
                                    <i aria-hidden="true" class="fas fa-key"></i>
                                </span>
                                <span><%= __("Copy Token") %></span>
                            </button>
                            <button class="button is-dark" onclick="copyToClipboard('https://api.discordextremelist.xyz/v1/bot/<%= bot._id %>/widget');">
                                <span class="icon">
                                    <i aria-hidden="true" class="fas fa-image"></i>
                                </span>
                                <span><%= __("Copy Widget Link") %></span>
                            </button>
                            <% if (bot.status.verified === false) { %>
                                <% if (bot.serverCount >= 100) { %>
                                    <a href="/apply/verification" class="button is-dark">
                                        <span class="icon">
                                            <i aria-hidden="true" class="fas fa-badge-check"></i>
                                        </span>
                                        <span><%= __("Apply for Verification") %></span>
                                    </a>
                                <% } %>
                            <% } %>
                            <% if (bot.status.approved === false && bot.vanityUrl !== "") { %>
                                <a href="" id="setVanity" class="button is-dark">
                                    <span class="icon">
                                        <i aria-hidden="true" class="fas fa-link"></i>
                                    </span>
                                    <span><%= __("Set Vanity URL") %></span>
                                </a>
                            <% } %>
                            <a href="/bots/<%= bot._id %>/edit" class="button is-dark">
                                <span class="icon">
                                    <i aria-hidden="true" class="fas fa-pencil"></i>
                                </span>
                                <span><%= __("Edit") %></span>
                            </a>
                            <a href="" id="deleteModal" class="button is-dark">
                                <span class="icon">
                                    <i aria-hidden="true" class="fas fa-trash"></i>
                                </span>
                                <span><%= __("Delete") %></span>
                            </a>
                        <% } else if (bot.editors && bot.editors.includes(req.user._id)) { %>
                            <button class="button is-dark" onclick="copyToClipboard('https://api.discordextremelist.xyz/v1/bot/<%= bot._id %>/widget');">
                                <span class="icon">
                                    <i aria-hidden="true" class="fas fa-image"></i>
                                </span>
                                <span><%= __("Copy Widget Link") %></span>
                            </button>
                            <a href="/bots/<%= bot._id %>/edit" class="button is-dark">
                                <span class="icon">
                                    <i aria-hidden="true" class="fas fa-pencil"></i>
                                </span>
                                <span><%= __("Edit") %></span>
                            </a>
                        <% } %>
                        <% if (user.db.rank.mod) { %>
                            <div class="dropdown">
                                <div class="dropdown-trigger">
                                  <button class="button is-dark" aria-haspopup="true" aria-controls="dropdown-ui-actions">
                                    <span class="icon">
                                        <i aria-hidden="true" class="fas fa-cogs" aria-hidden="true"></i>
                                    </span>
                                    <span><%= __("Staff Management") %></span>
                                    <span class="icon is-small">
                                      <i aria-hidden="true" class="fas fa-angle-down" aria-hidden="true"></i>
                                    </span>
                                  </button>
                                </div>
                                <div class="dropdown-menu" id="dropdown-ui-actions" role="menu">
                                  <div class="dropdown-content">
                                    <div class="dropdown-item">
                                        <p class="has-text-danger"><%= __("If you accidentally perform an action that is abusive or inappropriate please report it to a Website Administrator or Assistant instantly to prevent or minimise the severity of any penalties.") %></p>
                                    </div>
                                    <hr class="dropdown-divider">
                                    <% if (user.db.rank.assistant === true) { %>
                                        <% if (bot.status.verified === false) { %>
                                            <a class="dropdown-item" href="/bots/<%= bot._id %>/verify">
                                                <span class="icon"><i aria-hidden="true" class="fas fa-badge-check"></i></span>
                                                <span><%= __("Verify") %></span>
                                            </a>
                                        <% } else { %>
                                            <a class="dropdown-item" href="/bots/<%= bot._id %>/unverify">
                                                <span class="icon"><i aria-hidden="true" class="fas fa-badge"></i></span>
                                                <span><%= __("Unverify") %></span>
                                            </a>
                                        <% } %>
                                    <% } %>
                                    <% if (bot.status.approved === true) { %>
                                        <a class="dropdown-item" href="/bots/<%= bot._id %>/remove">
                                            <span class="icon"><i aria-hidden="true" class="fas fa-trash"></i></span>
                                            <span><%= __("Remove") %></span>
                                        </a>
                                    <% } else { %>
                                        <a class="dropdown-item" href="/bots/<%= bot._id %>/approve">
                                            <span class="icon"><i aria-hidden="true" class="fas fa-check"></i></span>
                                            <span><%= __("Approve") %></span>
                                        </a>
                                        <a class="dropdown-item" href="/bots/<%= bot._id %>/decline">
                                            <span class="icon"><i aria-hidden="true" class="fas fa-minus"></i></span>
                                            <span><%= __("Decline") %></span>
                                        </a>
                                        <a class="dropdown-item" target="_blank" href="https://discord.com/oauth2/authorize?client_id=<%= bot._id %>&scope=bot&guild_id=<%= staffServer %>">
                                            <span class="icon"><i class="fas fa-vial"></i></span>
                                            <span><%= __("Staff Server Invite") %></span>
                                        </a>
                                        <a class="dropdown-item" target="_blank" href="https://discord.com/oauth2/authorize?client_id=<%= bot._id %>&scope=bot&guild_id=<%= mainServer %>">
                                            <span class="icon"><i class="fas fa-shield-alt"></i></span>
                                            <span><%= __("Main Server Invite") %></span>
                                        </a>
                                    <% } %>
                                  </div>
                                </div>
                              </div>
                        <% } %>
                        </div>
                    <% } %>
                    <div class="buttons <% if (mobile) { %>is-centered<% } %>">
                        <% if (bot.links.website) { %>
                            <a target="_blank" rel="noopener" href="<%= bot.links.website %>" class="button is-link">
                                <span class="icon">
                                    <i aria-hidden="true" class="fas fa-globe"></i>
                                </span>
                                <span><%= __("Website") %></span>
                            </a>
                        <% } %>
                        <a target="_blank" href="/bots/<%= bot._id %>/invite" class="button is-info">
                            <span class="icon">
                                <i aria-hidden="true" class="fas fa-plus"></i>
                            </span>
                            <span><%= __("Invite") %></span>
                        </a>
                        <% if (bot.links.donation) { %>
                            <a target="_blank" rel="noopener" href="<%= bot.links.donation %>" class="button is-success">
                                <span class="icon">
                                    <i aria-hidden="true" class="fas fa-dollar-sign"></i>
                                </span>
                                <span><%= __("Donate") %></span>
                            </a>
                        <% } %>
                        <% if (bot.links.repo) { %>
                            <a target="_blank" rel="noopener" href="<%= bot.links.repo %>" class="button is-orange">
                                <span class="icon">
                                    <i aria-hidden="true" class="fas fa-code-branch"></i>
                                </span>
                                <span><%= __("Git Repository") %></span>
                            </a>
                        <% } %>
                        <% if (bot.links.support) { %>
                            <a target="_blank" rel="noopener" href="<%= bot.links.support %>" class="button is-danger">
                                <span class="icon">
                                    <i aria-hidden="true" class="fas fa-heart"></i>
                                </span>
                                <span><%= __("Support Server") %></span>
                            </a>
                        <% } %>
                    </div>
                    <div class="field is-grouped is-grouped-multiline <% if (mobile) { %>is-grouped-centered<% } %>">
                        <div class="control">
                            <div class="tags has-addons">
                                <span class="tag is-dark"><%= __("Prefix") %></span>
                                <span class="tag is-link"><%= bot.prefix %></span>
                            </div>
                        </div>
                        <div class="control">
                            <div class="tags has-addons">
                                <span class="tag is-dark"><%= __("Library") %></span>
                                <span class="tag is-info"><%= bot.library %></span>
                            </div>
                        </div>
                        <div class="control">
                            <div class="tags has-addons">
                                <span class="tag is-dark"><%= __("Servers") %></span>
                                <span class="tag is-success"><% if (bot.serverCount !== 0) { %><%= bot.serverCount %><% } else { %>???<% } %></span>
                            </div>
                        </div>
                        <div class="control">
                            <div class="tags has-addons">
                                <span class="tag is-dark"><%= __("Shards") %></span>
                                <span class="tag is-orange"><% if (bot.shardCount !== 0) { %><%= bot.shardCount %><% } else { %>???<% } %></span>
                            </div>
                        </div>
                        <div class="control">
                            <div class="tags has-addons">
                                <span class="tag is-dark"><%= __("Owner") %></span>
                                <span class="tag is-danger"><a class="has-text-white" href="/users/<%= bot.owner._id %>"><%= botOwner.fullUsername %></a></span>
                            </div>
                        </div>
                    </div>
                    <% if (bot.tags && bot.tags.length > 0) { %>
                        <div class="field is-grouped is-grouped-multiline <% if (mobile) { %>is-grouped-centered<% } %>">
                            <% if (bot.tags.includes("Fun")) { %>
                                <div class="control">
                                    <p class="tag is-link">
                                        <span class="icon">
                                            <i aria-hidden="true" class="fas fa-tag"></i>
                                        </span>
                                        <span><%= __("Fun") %></span>
                                    </p>
                                </div>
                            <% } %>
                            <% if (bot.tags.includes("Social")) { %>
                                <div class="control">
                                    <p class="tag is-info">
                                        <span class="icon">
                                            <i aria-hidden="true" class="fas fa-tag"></i>
                                        </span>
                                        <span><%= __("Social") %></span>
                                    </p>
                                </div>
                            <% } %>
                            <% if (bot.tags.includes("Economy")) { %>
                                <div class="control">
                                    <p class="tag is-success">
                                        <span class="icon">
                                            <i aria-hidden="true" class="fas fa-tag"></i>
                                        </span>
                                        <span><%= __("Economy") %></span>
                                    </p>
                                </div>
                            <% } %>
                            <% if (bot.tags.includes("Utility")) { %>
                                <div class="control">
                                    <p class="tag is-orange">
                                        <span class="icon">
                                            <i aria-hidden="true" class="fas fa-tag"></i>
                                        </span>
                                        <span><%= __("Utility") %></span>
                                    </p>
                                </div>
                            <% } %>
                            <% if (bot.tags.includes("Moderation")) { %>
                                <div class="control">
                                    <span class="tag is-danger">
                                        <span class="icon">
                                            <i aria-hidden="true" class="fas fa-tag"></i>
                                        </span>
                                        <span><%= __("Moderation") %></span>
                                    </span>
                                </div>
                            <% } %>
                            <% if (bot.tags.includes("Multipurpose")) { %>
                                <div class="control">
                                    <p class="tag is-magenta">
                                        <span class="icon">
                                            <i aria-hidden="true" class="fas fa-tag"></i>
                                        </span>
                                        <span><%= __("Multipurpose") %></span>
                                    </p>
                                </div>
                            <% } %>
                            <% if (bot.tags.includes("Music")) { %>
                                <div class="control">
                                    <p class="tag is-pink">
                                        <span class="icon">
                                            <i aria-hidden="true" class="fas fa-tag"></i>
                                        </span>
                                        <span><%= __("Music") %></span>
                                    </p>
                                </div>
                            <% } %>
                        </div>
                    <% } %>
                </div>
            </div>
            <% if (req.user) { %>
                <% if (req.user.db.rank.mod === true) { %>
                    <% if (bot.modNotes && bot.status.approved === false) { %>
                        <div class="container">
                            <article class="message is-blurple">
                                <div class="message-header">
                                    <p class="has-text-primary"><%= __("Mod Notes") %></p>
                                </div>
                                <div class="message-body has-background-black">
                                    <%= bot.modNotes %>
                                </div>
                            </article>
                        </div>
                        <br />
                    <% } %>
                <% } %>
            <% } %>
        </div>
    </div>
</section>
<div class="container" style="overflow: hidden;">
    <div id="content" class="section content" style="white-space: pre;"></div>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script> 
    <script>
        document.getElementById('content').innerHTML = marked(`<%- longDesc %>`);
    </script> 
</div>
<div class="modal deleteModal">
    <div class="modal-background"></div>
    <div class="modal-card">
        <header class="modal-card-head">
            <p class="modal-card-title has-text-danger"><%= __("Warning!") %></p>
        </header>
        <section class="modal-card-body has-text-danger">
            <%= __("This action is irreversible, when you click Delete your bot's data will be immediately erased from our database with no way of restoring it.") %>
        </section>
        <footer class="modal-card-foot">
            <div class="buttons">
                <a class="button is-success" href="/bots/<%= bot._id %>/delete">
                    <span class="icon">
                        <i aria-hidden="true" class="fas fa-check-circle"></i>
                    </span>
                    <span><%= __("Delete") %></span>
                </a>
                <button class="button is-danger" id="close-modal">
                    <span class="icon">
                        <i aria-hidden="true" class="fas fa-times-circle"></i>
                    </span>
                    <span><%= __("Cancel") %></span>
                </button>
            </div>
        </footer>
    </div>
    <script type="text/javascript">document.querySelector("a#deleteModal").addEventListener("click",function(event){event.preventDefault();const modal=document.querySelector(".deleteModal");const html=document.querySelector("html");modal.classList.add("is-active");html.classList.add("is-clipped");modal.querySelector(".modal-background").addEventListener("click",function(e){e.preventDefault();modal.classList.remove("is-active");html.classList.remove("is-clipped")});document.querySelector("button#close-modal").addEventListener("click",function(e){e.preventDefault();modal.classList.remove("is-active");html.classList.remove("is-clipped")})})</script>
</div>
<div class="modal setVanity">
    <div class="modal-background" id="vanityModalBg"></div>
    <div class="modal-card">
        <header class="modal-card-head">
            <p class="modal-card-title has-text-danger"><%= __("Set Vanity URL") %></p>
        </header>
        <form action="/bots/<%= bot._id %>/setvanity" method="POST">
            <section class="modal-card-body has-text-danger">
                <%= __("Your Vanity URL cannot be changed once set, choose carefully!") %>
                <div>
                    <br />
                    <div class="field">
                        <p class="control has-icons-left has-icons-right">
                            <input class="input is-rounded" type="text" name="vanity" placeholder="<%= __("Example:") %> <%= bot.name.toLowerCase() %>" required>
                            <span class="icon is-small is-left">
                                <i aria-hidden="true" class="fas fa-link"></i>
                            </span>
                        </p>
                    </div>
                </div>
            </section>
            <footer class="modal-card-foot">
                <div class="buttons">
                    <button class="button is-success">
                        <span class="icon">
                            <i aria-hidden="true" class="fas fa-check-circle"></i>
                        </span>
                        <span><%= __("Set") %></span>
                    </button>
                    <button class="button is-danger" id="close-modal2">
                        <span class="icon">
                            <i aria-hidden="true" class="fas fa-times-circle"></i>
                        </span>
                        <span><%= __("Cancel") %></span>
                    </button>
                </div>
            </footer>
        </form>
    </div>
    <script type="text/javascript">document.querySelector("a#setVanity").addEventListener("click",function(event){event.preventDefault();const modal=document.querySelector(".setVanity");const html=document.querySelector("html");modal.classList.add("is-active");html.classList.add("is-clipped");modal.querySelector(".modal-background").addEventListener("click",function(e){e.preventDefault();modal.classList.remove("is-active");html.classList.remove("is-clipped")});document.querySelector("button#close-modal2").addEventListener("click",function(e){e.preventDefault();modal.classList.remove("is-active");html.classList.remove("is-clipped")})})</script>
</div>

<% if (req.user && bot.owner._id === req.user._id || req.user && req.user.db.rank.mod === true) { %>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css" integrity="sha384-OHBBOqpYHNsIqQy8hL1U+8OXf9hH6QRxi0+EODezv82DfnZoV7qoHAZDwMwEJvSw" crossorigin="anonymous">
    <script type="text/javascript" src="/js/bulma-toast.min.js" async></script>
    <%
        const defaultColour = req.user.db.preferences.defaultColour || "#b114ff";
        const foreground = req.user.db.preferences.defaultForegroundColour || "#ffffff";
    %>
    <style type="text/css">.notification.is-default.animated{color:<%= foreground %>;background-color:<%= defaultColour %>;border-radius:3%}</style>
    <script type="text/javascript">function copyToClipboard(t){const hideWB=document.createElement("style");hideWB.innerHTML="widgetbot-crate {display: none;}";document.body.appendChild(hideWB);const e=document.createElement("textarea");e.value=t,e.setAttribute("readonly",""),e.style={position:"absolute",left:"-9999px"},document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),bulmaToast.toast({message:"Copied to clipboard",type:"is-default",position:"bottom-right",duration:2e3,opacity:.75,animate:{in:"fadeInRight",out:"fadeOutRight"}});setTimeout(()=>{hideWB.innerHTML="widgetbot-crate {display: block;}"},3000)}</script>
    <script type="text/javascript">const dropdowns=document.querySelectorAll(".dropdown:not(.is-hoverable)");function closeDropdowns(){dropdowns.forEach(function(o){o.classList.remove("is-active")})}dropdowns.length>0&&(dropdowns.forEach(function(o){o.addEventListener("click",function(n){n.stopPropagation(),o.classList.toggle("is-active")})}),document.addEventListener("click",function(o){closeDropdowns()})),document.addEventListener("keydown",function(o){let n=o||window.event;"Esc"!==n.key&&"Escape"!==n.key||closeDropdowns()});</script>
<% } %>
<% if (bot.widgetbot.channel !== "" && bot.widgetbot.channel !== "") { %>
    <% if (bot.widgetbot.options !== "") { %>
        <script src="https://cdn.jsdelivr.net/npm/@widgetbot/crate@3" async defer>const additionalOptions = JSON.parse(<%- JSON.stringify(bot.widgetbot.options) %>);const crate = new Crate({server:"<%= bot.widgetbot.server %>",channel:"<%= bot.widgetbot.channel %>",shard:"https://e.widgetbot.io",...additionalOptions});</script>
    <% } else { %>
        <script src="https://cdn.jsdelivr.net/npm/@widgetbot/crate@3" async defer>const crate = new Crate({server:"<%= bot.widgetbot.server %>",channel:"<%= bot.widgetbot.channel %>",shard:"https://e.widgetbot.io"});</script>
    <% } %>
<% } %>
<%- include("../../partials/footer.ejs") %>
